<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>IITB LCS Project Data Collection Portal</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500|Poppins:400,500,600,700|Roboto:400,500"
        rel="stylesheet" />
    <link href="https://cdn.materialdesignicons.com/4.4.95/css/materialdesignicons.min.css" rel="stylesheet" />
    <link href="assets/plugins/simplebar/simplebar.css" rel="stylesheet" />
    <link href="assets/plugins/nprogress/nprogress.css" rel="stylesheet" />
    <link href='assets/plugins/jvectormap/jquery-jvectormap-2.0.3.css' rel='stylesheet'>
    <link href='assets/plugins/daterangepicker/daterangepicker.css' rel='stylesheet'>
    <link href='assets/plugins/toastr/toastr.min.css' rel='stylesheet'>
    <link id="sleek-css" rel="stylesheet" href="assets/css/sleek.css" />
    <link href="assets/img/favicon.png" rel="shortcut icon" />
    <script src="assets/plugins/nprogress/nprogress.js"></script>
</head>

<body class="header-fixed sidebar-fixed sidebar-dark header-light" id="body">
    <script>
        NProgress.configure({ showSpinner: false });
        NProgress.start();
    </script>
    <div class="wrapper">

        <!-- ====================================
          ——— LEFT SIDEBAR WITH OUT FOOTER
        ===================================== -->
        <aside class="left-sidebar bg-sidebar">
            <div data-include="sidebar"></div>
        </aside>


        <!-- ====================================
        ——— PAGE WRAPPER
        ===================================== -->
        <div class="page-wrapper">
            <!-- ====================================
          ——— CONTENT WRAPPER
          ===================================== -->
            <div class="content-wrapper">
                <div class="content">
                    <div class="row">
                        <div class="col-12">
                            <button id="Grimm" onclick="button_clicked('Grimm')" class="mb-1 btn btn-outline-primary">
                                GRIMM
                            </button>
                            <button id="Partector" onclick="button_clicked('Partector')"
                                class="mb-1 btn btn-outline-primary">
                                Partector </button>
                            <button id="N3" onclick="button_clicked('N3')" class="mb-1 btn btn-outline-primary">
                                Alphasense
                                OPC-N3 </button>
                            <button id="PurpleAir" onclick="button_clicked('PurpleAir')"
                                class="mb-1 btn btn-outline-primary">
                                PurpleAir Flex II </button>
                            <button id="Atmos" onclick="button_clicked('Atmos')" class="mb-1 btn btn-outline-primary">
                                UrbanSciences Atmos </button>
                            <input type="radio" name="raw" value="raw">
                            <label for="raw">Raw Data</label>
                            <input type="radio" name="raw" value="clean">
                            <label for="clean">Clean Data</label>
                        </div>

                        <div class="col-12">
                            <div class="card card-default">
                                <div class="card-header card-header-border-bottom d-flex justify-content-center">
                                    <h2>View Data</h2>
                                </div>

                                <div class="card-body" style="max-width: 100%;overflow-x: auto;">
                                    <div class="responsive-data-table" id="datatable">
                                        <!-- <table id="responsive-data-table" class="table dt-responsive nowrap"
                                            style="width:100%" id="datatable">
                                            <thead>
                                                <tr>
                                                    <th>First name</th>
                                                    <th>Last name</th>
                                                    <th>Position</th>
                                                    <th>Office</th>
                                                    <th>Age</th>
                                                    <th>Start date</th>
                                                    <th>Salary</th>
                                                    <th>Extn.</th>
                                                    <th>E-mail</th>
                                                </tr>
                                            </thead>

                                            <tbody>
                                                <tr>
                                                    <td>Tiger</td>
                                                    <td>Nixon</td>
                                                    <td>System Architect</td>
                                                    <td>Edinburgh</td>
                                                    <td>61</td>
                                                    <td>2011/04/25</td>
                                                    <td>$320,800</td>
                                                    <td>5421</td>
                                                    <td>t.nixon@datatables.net</td>
                                                </tr>
                                            </tbody>
                                        </table> -->
                                        <table class="table dt-responsive nowrap" style="width:100%" id="table">

                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                </div> <!-- End Content -->
            </div> <!-- End Content Wrapper -->
        </div> <!-- End Page Wrapper -->
    </div> <!-- End Wrapper -->
    <script src="assets/plugins/jquery/jquery.min.js"></script>
    <script src="assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- <script src="assets/plugins/simplebar/simplebar.min.js"></script> -->
    <script src='assets/plugins/charts/Chart.min.js'></script>
    <script src='assets/js/chart.js'></script>
    <script src='assets/plugins/jvectormap/jquery-jvectormap-2.0.3.min.js'></script>
    <script src='assets/plugins/jvectormap/jquery-jvectormap-world-mill.js'></script>
    <script src='assets/js/vector-map.js'></script>
    <script src='assets/plugins/daterangepicker/moment.min.js'></script>
    <script src='assets/plugins/daterangepicker/daterangepicker.js'></script>
    <script src='assets/js/date-range.js'></script>
    <script src="assets/js/sleek.js"></script>
    <link href="assets/options/optionswitch.css" rel="stylesheet">
    <script src="assets/options/optionswitcher.js"></script>

    <style>
        thead tr th:first-child,
        tbody tr td:first-child {
            width: 12em;
            min-width: 12em;
            max-width: 12em;
            word-break: break-all;
        }
    </style>

    <script>
        // Function to convert JSON data to HTML table
        // window.onload = button_clicked;
        function convert(data) {
            //Empty all child elements
            $('#table').empty()

            // Sample JSON data
            let jsonData = data
            console.log(data.PromiseResult)

            // Get the container element where the table will be inserted
            // let container = $("#container");

            // Create the table element
            let table = $("#table");

            // Get the keys (column names) of the first object in the JSON data
            let cols = Object.keys(jsonData[0]);

            // Create the header element
            let thead = $("<thead>");
            let tr = $("<tr class=table-headers>");

            // Loop through the column names and create header cells
            $.each(cols, function (i, item) {
                let th = $('<th>');
                th.text(item); // Set the column name as the text of the header cell
                tr.append(th); // Append the header cell to the header row
            });
            thead.append(tr); // Append the header row to the header
            table.append(thead) // Append the header to the table

            let tbody = $("<tbody>")
            // Loop through the JSON data and create table rows
            $.each(jsonData, function (i, item) {
                let tr = $("<tr>");

                // Get the values of the current object in the JSON data
                let vals = Object.values(item);

                // Loop through the values and create table cells
                $.each(vals, (i, elem) => {
                    let td = $("<td>");
                    td.text(elem); // Set the value as the text of the table cell
                    tr.append(td); // Append the table cell to the table row
                });
                tbody.append(tr); // Append the table row to the table
            });
            table.append(tbody);
            $("datatable").append(table)
            // container.append(table) // Append the table to the container element
        }
        async function button_clicked(button) {
            console.log(button)
            const response = await fetch('/getData/' + button + '/' + $('input[name="raw"]:checked').val())
            const data = await response.json();
            convert(data)
        }
    </script>
</body>

</html>